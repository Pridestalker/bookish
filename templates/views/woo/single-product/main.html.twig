{% extends 'layouts/app.twig' %}

{% block navbar %}
    {{ parent() }}

    <div class="container mx-auto pt-4">
        <nav aria-label="breadcrumb" class="product-breadcrumbs">
            <a href="{{ site.link }}">Home</a>
            {{ product.get_product_categories_links('') }}
            <a href="{{ product.get_link }}" aria-current="page">{{ product.get_title }}</a>
        </nav>
    </div>
{% endblock %}

{% block content %}
    <main class="container mx-auto">
        <h1>{{ product.get_title }}</h1>

        <section class="main-content py-4">
            <div>
                {% block productGallery %}
                    <gallery-group>
                        <gallery-item name="thumnail" src="{{ product.thumbnail.src|resize(450,450) }}" alt="{{ product.get_title }}" active></gallery-item>
                        {% for item in product.gallery_items %}
                            {% set gallery_item = Image(item) %}
                            {{ gallery_item.slug }}
                            <gallery-item name="gallery-{{ loop.index }}" src="{{ gallery_item.src|resize(450,450) }}" aly="{{ gallery_item.alt }}"></gallery-item>
                        {% endfor %}
                    </gallery-group>
                {% endblock %}
            </div>

            <aside class="product-sidebar">
                <h2 class="product-price">
                    {% block productPrice %}
                    &euro; {{ product.get_price }}
                    {% endblock %}
                </h2>

                <form action="{{ product.product.get_permalink|filter('woocommerce_add_to_cart_form_action') }}" method="post" enctype="multipart/form-data">

                    {% do action('woocommerce_before_add_to_cart_quantity') %}
                    <input type="number" min="{{ product.product.get_min_purchase_quantity }}" max="{{ product.product.get_max_purchase_quantity }}" />

                    {% do action('woocommerce_after_add_to_cart_quantity') %}

                    {% block productAddToCart %}
                        {% do action('woocommerce_before_add_to_cart_button') %}
                        <button type="submit" name="add-to-cart" value="{{ product.id }}" class="product-add-to-cart">
                            <i class="fad fa-plus-hexagon"></i>
                            <span>Toevoegen aan winkelmand</span>
                        </button>
                        {% do action('woocommerce_after_add_to_cart_button') %}
                    {% endblock %}

                </form>


                {% block productStock %}
                    {% if product.is_in_stock %}
                        <p class="text-primary">
                            <i class="fad fa-box-check mr-2"></i>
                            <span>Op voorraad! Binnen 2-4 dagen verzonden.</span>
                        </p>
                    {% elseif product.can_backorder %}
                        <p>
                            <i class="fad fa-exclamation-circle mr-2"></i>
                            <span>Tijdelijk niet op voorraad.</span>
                        </p>
                    {% else %}
                        <p class="text-red">
                            <i class="fad fa-exclamation-circle mr-2"></i>
                            <span>Niet op voorraad</span>
                        </p>
                    {% endif %}
                {% endblock %}
            </aside>
        </section>

        <section class="py-4">
            <tab-group>
                <tab-item name="Omschrijving" active>
                    <div class="product-description content">
                        {{ product.content|wpautop }}

                        <p>
                            <em>
                                Alle producten worden handgemaakt,
                                de print en het formaat kunnen dus iets afwijken van de foto's
                            </em>
                        </p>
                    </div>
                </tab-item>
                <tab-item name="Eigenschappen">
                    <table class="attribute-table">
                        {% for attribute in product.get_attributes %}
                            <tr>
                                <th>
                                    {{ attribute.name|capitalize }}
                                </th>
                                <td>
                                    {% for option in attribute.options %}
                                        {{ option.name }}{% if not loop.last %}, {% endif %}
                                    {% endfor %}
                                </td>
                            </tr>
                        {% endfor %}
                    </table>
                </tab-item>
            </tab-group>
        </section>

        <section class="related-products py-4">
            <h2 class="pb-4">Gerelateerde producten</h2>

            <div class="products-list">
                {% for related in product.related_products %}
                    {{ include([
                        'partials/tease/product/' ~ related.slug ~ '.html.twig',
                        'partials/tease/product.html.twig'
                    ], { product: related }, with_context = false) }}
                {% endfor %}
            </div>
        </section>
    </main>
{% endblock %}

{% block footer %}
    {{ parent() }}
{% endblock %}
